
*********************************************************
This was run on:
Sun Nov 25 09:53:42 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5093 is running on node05 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 3626
NUM_VALIDATION: 514
NUM_EPOCHS: 50
BATCH_SIZE: 2
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Old weights found!
Old weights loaded successfully!
Epoch 1/50
 - 839s - loss: 0.0781 - acc: 0.3047 - val_loss: 0.0593 - val_acc: 0.1569

Epoch 00001: val_loss improved from inf to 0.05932, saving model to saved_models/model_and_weights.hdf5
Epoch 2/50
 - 794s - loss: 0.0772 - acc: 0.3040 - val_loss: 0.0585 - val_acc: 0.1559

Epoch 00002: val_loss improved from 0.05932 to 0.05854, saving model to saved_models/model_and_weights.hdf5
Epoch 3/50
 - 794s - loss: 0.0763 - acc: 0.3034 - val_loss: 0.0578 - val_acc: 0.1551

Epoch 00003: val_loss improved from 0.05854 to 0.05780, saving model to saved_models/model_and_weights.hdf5
Epoch 4/50
 - 795s - loss: 0.0755 - acc: 0.3030 - val_loss: 0.0571 - val_acc: 0.1550

Epoch 00004: val_loss improved from 0.05780 to 0.05712, saving model to saved_models/model_and_weights.hdf5
Epoch 5/50
 - 794s - loss: 0.0748 - acc: 0.3027 - val_loss: 0.0565 - val_acc: 0.1549

Epoch 00005: val_loss improved from 0.05712 to 0.05651, saving model to saved_models/model_and_weights.hdf5
Epoch 6/50
 - 795s - loss: 0.0742 - acc: 0.3026 - val_loss: 0.0559 - val_acc: 0.1542

Epoch 00006: val_loss improved from 0.05651 to 0.05592, saving model to saved_models/model_and_weights.hdf5
Epoch 7/50
 - 793s - loss: 0.0736 - acc: 0.3024 - val_loss: 0.0554 - val_acc: 0.1535

Epoch 00007: val_loss improved from 0.05592 to 0.05539, saving model to saved_models/model_and_weights.hdf5
Epoch 8/50
 - 794s - loss: 0.0731 - acc: 0.3024 - val_loss: 0.0549 - val_acc: 0.1529

Epoch 00008: val_loss improved from 0.05539 to 0.05493, saving model to saved_models/model_and_weights.hdf5
Epoch 9/50
 - 794s - loss: 0.0726 - acc: 0.3025 - val_loss: 0.0545 - val_acc: 0.1523

Epoch 00009: val_loss improved from 0.05493 to 0.05448, saving model to saved_models/model_and_weights.hdf5
Epoch 10/50
 - 794s - loss: 0.0721 - acc: 0.3026 - val_loss: 0.0541 - val_acc: 0.1521

Epoch 00010: val_loss improved from 0.05448 to 0.05408, saving model to saved_models/model_and_weights.hdf5
Epoch 11/50
 - 794s - loss: 0.0717 - acc: 0.3029 - val_loss: 0.0537 - val_acc: 0.1522

Epoch 00011: val_loss improved from 0.05408 to 0.05370, saving model to saved_models/model_and_weights.hdf5
Epoch 12/50
 - 793s - loss: 0.0713 - acc: 0.3032 - val_loss: 0.0534 - val_acc: 0.1523

Epoch 00012: val_loss improved from 0.05370 to 0.05337, saving model to saved_models/model_and_weights.hdf5
Epoch 13/50
 - 795s - loss: 0.0709 - acc: 0.3034 - val_loss: 0.0531 - val_acc: 0.1522

Epoch 00013: val_loss improved from 0.05337 to 0.05305, saving model to saved_models/model_and_weights.hdf5
Epoch 14/50
 - 795s - loss: 0.0706 - acc: 0.3037 - val_loss: 0.0528 - val_acc: 0.1532

Epoch 00014: val_loss improved from 0.05305 to 0.05278, saving model to saved_models/model_and_weights.hdf5
Epoch 15/50
 - 797s - loss: 0.0702 - acc: 0.3041 - val_loss: 0.0525 - val_acc: 0.1536

Epoch 00015: val_loss improved from 0.05278 to 0.05253, saving model to saved_models/model_and_weights.hdf5
Epoch 16/50
 - 795s - loss: 0.0699 - acc: 0.3045 - val_loss: 0.0523 - val_acc: 0.1546

Epoch 00016: val_loss improved from 0.05253 to 0.05227, saving model to saved_models/model_and_weights.hdf5
Epoch 17/50
 - 795s - loss: 0.0696 - acc: 0.3050 - val_loss: 0.0521 - val_acc: 0.1550

Epoch 00017: val_loss improved from 0.05227 to 0.05206, saving model to saved_models/model_and_weights.hdf5
Epoch 18/50
 - 797s - loss: 0.0693 - acc: 0.3054 - val_loss: 0.0519 - val_acc: 0.1550

Epoch 00018: val_loss improved from 0.05206 to 0.05185, saving model to saved_models/model_and_weights.hdf5
Epoch 19/50
 - 797s - loss: 0.0691 - acc: 0.3058 - val_loss: 0.0517 - val_acc: 0.1555

Epoch 00019: val_loss improved from 0.05185 to 0.05166, saving model to saved_models/model_and_weights.hdf5
Epoch 20/50
 - 794s - loss: 0.0688 - acc: 0.3063 - val_loss: 0.0515 - val_acc: 0.1558

Epoch 00020: val_loss improved from 0.05166 to 0.05150, saving model to saved_models/model_and_weights.hdf5
Epoch 21/50
 - 795s - loss: 0.0686 - acc: 0.3068 - val_loss: 0.0513 - val_acc: 0.1553

Epoch 00021: val_loss improved from 0.05150 to 0.05134, saving model to saved_models/model_and_weights.hdf5
Epoch 22/50
 - 795s - loss: 0.0683 - acc: 0.3074 - val_loss: 0.0512 - val_acc: 0.1559

Epoch 00022: val_loss improved from 0.05134 to 0.05119, saving model to saved_models/model_and_weights.hdf5
Epoch 23/50
 - 794s - loss: 0.0681 - acc: 0.3078 - val_loss: 0.0510 - val_acc: 0.1564

Epoch 00023: val_loss improved from 0.05119 to 0.05104, saving model to saved_models/model_and_weights.hdf5
Epoch 24/50
 - 795s - loss: 0.0679 - acc: 0.3084 - val_loss: 0.0509 - val_acc: 0.1567

Epoch 00024: val_loss improved from 0.05104 to 0.05091, saving model to saved_models/model_and_weights.hdf5
Epoch 25/50
 - 796s - loss: 0.0677 - acc: 0.3089 - val_loss: 0.0508 - val_acc: 0.1563

Epoch 00025: val_loss improved from 0.05091 to 0.05079, saving model to saved_models/model_and_weights.hdf5
Epoch 26/50
 - 796s - loss: 0.0675 - acc: 0.3093 - val_loss: 0.0507 - val_acc: 0.1562

Epoch 00026: val_loss improved from 0.05079 to 0.05069, saving model to saved_models/model_and_weights.hdf5
Epoch 27/50
 - 797s - loss: 0.0673 - acc: 0.3099 - val_loss: 0.0506 - val_acc: 0.1565

Epoch 00027: val_loss improved from 0.05069 to 0.05056, saving model to saved_models/model_and_weights.hdf5
Epoch 28/50
 - 794s - loss: 0.0671 - acc: 0.3105 - val_loss: 0.0505 - val_acc: 0.1568

Epoch 00028: val_loss improved from 0.05056 to 0.05046, saving model to saved_models/model_and_weights.hdf5
Epoch 29/50
 - 795s - loss: 0.0669 - acc: 0.3108 - val_loss: 0.0504 - val_acc: 0.1564

Epoch 00029: val_loss improved from 0.05046 to 0.05036, saving model to saved_models/model_and_weights.hdf5
Epoch 30/50
 - 795s - loss: 0.0667 - acc: 0.3115 - val_loss: 0.0503 - val_acc: 0.1566

Epoch 00030: val_loss improved from 0.05036 to 0.05026, saving model to saved_models/model_and_weights.hdf5
Epoch 31/50
 - 796s - loss: 0.0665 - acc: 0.3121 - val_loss: 0.0502 - val_acc: 0.1565

Epoch 00031: val_loss improved from 0.05026 to 0.05018, saving model to saved_models/model_and_weights.hdf5
Epoch 32/50
 - 796s - loss: 0.0664 - acc: 0.3125 - val_loss: 0.0501 - val_acc: 0.1571

Epoch 00032: val_loss improved from 0.05018 to 0.05010, saving model to saved_models/model_and_weights.hdf5
Epoch 33/50
 - 794s - loss: 0.0662 - acc: 0.3130 - val_loss: 0.0500 - val_acc: 0.1568

Epoch 00033: val_loss improved from 0.05010 to 0.05001, saving model to saved_models/model_and_weights.hdf5
Epoch 34/50
 - 798s - loss: 0.0660 - acc: 0.3135 - val_loss: 0.0499 - val_acc: 0.1569

Epoch 00034: val_loss improved from 0.05001 to 0.04994, saving model to saved_models/model_and_weights.hdf5
Epoch 35/50
 - 798s - loss: 0.0659 - acc: 0.3141 - val_loss: 0.0499 - val_acc: 0.1571

Epoch 00035: val_loss improved from 0.04994 to 0.04987, saving model to saved_models/model_and_weights.hdf5
Epoch 36/50
 - 798s - loss: 0.0657 - acc: 0.3145 - val_loss: 0.0498 - val_acc: 0.1574

Epoch 00036: val_loss improved from 0.04987 to 0.04979, saving model to saved_models/model_and_weights.hdf5
Epoch 37/50
 - 793s - loss: 0.0656 - acc: 0.3150 - val_loss: 0.0497 - val_acc: 0.1571

Epoch 00037: val_loss improved from 0.04979 to 0.04973, saving model to saved_models/model_and_weights.hdf5
Epoch 38/50
 - 795s - loss: 0.0654 - acc: 0.3155 - val_loss: 0.0497 - val_acc: 0.1574

Epoch 00038: val_loss improved from 0.04973 to 0.04966, saving model to saved_models/model_and_weights.hdf5
Epoch 39/50
 - 799s - loss: 0.0653 - acc: 0.3160 - val_loss: 0.0496 - val_acc: 0.1577

Epoch 00039: val_loss improved from 0.04966 to 0.04960, saving model to saved_models/model_and_weights.hdf5
Epoch 40/50
 - 793s - loss: 0.0652 - acc: 0.3164 - val_loss: 0.0495 - val_acc: 0.1573

Epoch 00040: val_loss improved from 0.04960 to 0.04955, saving model to saved_models/model_and_weights.hdf5
Epoch 41/50
 - 794s - loss: 0.0650 - acc: 0.3169 - val_loss: 0.0495 - val_acc: 0.1575

Epoch 00041: val_loss improved from 0.04955 to 0.04950, saving model to saved_models/model_and_weights.hdf5
Epoch 42/50
 - 796s - loss: 0.0649 - acc: 0.3174 - val_loss: 0.0495 - val_acc: 0.1577

Epoch 00042: val_loss improved from 0.04950 to 0.04946, saving model to saved_models/model_and_weights.hdf5

Epoch 00042: ReduceLROnPlateau reducing learning rate to 2.499999936844688e-06.
Epoch 43/50
 - 794s - loss: 0.0648 - acc: 0.3175 - val_loss: 0.0494 - val_acc: 0.1575

Epoch 00043: val_loss improved from 0.04946 to 0.04943, saving model to saved_models/model_and_weights.hdf5
Epoch 44/50
 - 793s - loss: 0.0648 - acc: 0.3178 - val_loss: 0.0494 - val_acc: 0.1579

Epoch 00044: val_loss improved from 0.04943 to 0.04943, saving model to saved_models/model_and_weights.hdf5
Epoch 45/50
 - 795s - loss: 0.0648 - acc: 0.3177 - val_loss: 0.0494 - val_acc: 0.1576

Epoch 00045: val_loss improved from 0.04943 to 0.04943, saving model to saved_models/model_and_weights.hdf5

Epoch 00045: ReduceLROnPlateau reducing learning rate to 6.24999984211172e-07.
Epoch 46/50
 - 798s - loss: 0.0648 - acc: 0.3177 - val_loss: 0.0494 - val_acc: 0.1574

Epoch 00046: val_loss improved from 0.04943 to 0.04942, saving model to saved_models/model_and_weights.hdf5
Epoch 47/50
 - 796s - loss: 0.0648 - acc: 0.3177 - val_loss: 0.0494 - val_acc: 0.1577

Epoch 00047: val_loss did not improve from 0.04942

Epoch 00047: ReduceLROnPlateau reducing learning rate to 1.56249996052793e-07.
Epoch 48/50
 - 795s - loss: 0.0648 - acc: 0.3178 - val_loss: 0.0494 - val_acc: 0.1577

Epoch 00048: val_loss did not improve from 0.04942
Epoch 49/50
 - 795s - loss: 0.0648 - acc: 0.3178 - val_loss: 0.0494 - val_acc: 0.1579

Epoch 00049: val_loss improved from 0.04942 to 0.04942, saving model to saved_models/model_and_weights.hdf5

Epoch 00049: ReduceLROnPlateau reducing learning rate to 3.906249901319825e-08.
Epoch 50/50
 - 794s - loss: 0.0648 - acc: 0.3178 - val_loss: 0.0494 - val_acc: 0.1578

Epoch 00050: val_loss did not improve from 0.04942
*********************************************************
Running python analyze_model.py
JOB 5093 is running on node05 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25
IoU for Background is: 0.509
IoU for Cosmic is: 0.026
IoU for Beam is: 0.024
Average IoU is: 0.186

Test accuracy of the model is: 33.33%

Done!

