
*********************************************************
This was run on:
Thu Dec 27 19:03:48 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5419 is running on node01 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 3626
NUM_VALIDATION: 514
NUM_EPOCHS: 20
BATCH_SIZE: 5
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Epoch 1/20
 - 160s - loss: 0.0461 - acc: 0.0920 - val_loss: 0.0553 - val_acc: 0.0933

Epoch 00001: val_loss improved from inf to 0.05531, saving model to saved_models/model_and_weights.hdf5
Epoch 2/20
 - 158s - loss: 0.0390 - acc: 0.5554 - val_loss: 0.0437 - val_acc: 0.0820

Epoch 00002: val_loss improved from 0.05531 to 0.04370, saving model to saved_models/model_and_weights.hdf5
Epoch 3/20
 - 158s - loss: 0.0378 - acc: 0.7697 - val_loss: 0.0733 - val_acc: 0.0766

Epoch 00003: val_loss did not improve from 0.04370
Epoch 4/20
 - 157s - loss: 0.0372 - acc: 0.7669 - val_loss: 0.0918 - val_acc: 0.0770

Epoch 00004: val_loss did not improve from 0.04370
Epoch 5/20
 - 157s - loss: 0.0368 - acc: 0.7618 - val_loss: 0.0598 - val_acc: 0.0856

Epoch 00005: val_loss did not improve from 0.04370

Epoch 00005: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
Epoch 6/20
 - 155s - loss: 0.0366 - acc: 0.7833 - val_loss: 0.0405 - val_acc: 0.8216

Epoch 00006: val_loss improved from 0.04370 to 0.04045, saving model to saved_models/model_and_weights.hdf5
Epoch 7/20
 - 155s - loss: 0.0366 - acc: 0.7793 - val_loss: 0.0440 - val_acc: 0.8330

Epoch 00007: val_loss did not improve from 0.04045
Epoch 8/20
 - 154s - loss: 0.0365 - acc: 0.7897 - val_loss: 0.0393 - val_acc: 0.1335

Epoch 00008: val_loss improved from 0.04045 to 0.03927, saving model to saved_models/model_and_weights.hdf5
Epoch 9/20
 - 155s - loss: 0.0364 - acc: 0.7927 - val_loss: 0.0409 - val_acc: 0.1147

Epoch 00009: val_loss did not improve from 0.03927
Epoch 10/20
 - 155s - loss: 0.0363 - acc: 0.7920 - val_loss: 0.0396 - val_acc: 0.8368

Epoch 00010: val_loss did not improve from 0.03927
Epoch 11/20
 - 155s - loss: 0.0363 - acc: 0.7935 - val_loss: 0.0400 - val_acc: 0.1301

Epoch 00011: val_loss did not improve from 0.03927

Epoch 00011: ReduceLROnPlateau reducing learning rate to 6.25000029685907e-05.
Epoch 12/20
 - 156s - loss: 0.0362 - acc: 0.7928 - val_loss: 0.0390 - val_acc: 0.8331

Epoch 00012: val_loss improved from 0.03927 to 0.03898, saving model to saved_models/model_and_weights.hdf5
Epoch 13/20
 - 155s - loss: 0.0362 - acc: 0.7886 - val_loss: 0.0388 - val_acc: 0.8142

Epoch 00013: val_loss improved from 0.03898 to 0.03878, saving model to saved_models/model_and_weights.hdf5
Epoch 14/20
 - 155s - loss: 0.0361 - acc: 0.7889 - val_loss: 0.0388 - val_acc: 0.1224

Epoch 00014: val_loss did not improve from 0.03878
Epoch 15/20
 - 155s - loss: 0.0361 - acc: 0.7952 - val_loss: 0.0387 - val_acc: 0.8180

Epoch 00015: val_loss improved from 0.03878 to 0.03871, saving model to saved_models/model_and_weights.hdf5
Epoch 16/20
 - 157s - loss: 0.0360 - acc: 0.8023 - val_loss: 0.0388 - val_acc: 0.1150

Epoch 00016: val_loss did not improve from 0.03871

Epoch 00016: ReduceLROnPlateau reducing learning rate to 1.5625000742147677e-05.
Epoch 17/20
 - 155s - loss: 0.0360 - acc: 0.8029 - val_loss: 0.0387 - val_acc: 0.1110

Epoch 00017: val_loss improved from 0.03871 to 0.03867, saving model to saved_models/model_and_weights.hdf5
Epoch 18/20
 - 155s - loss: 0.0360 - acc: 0.8027 - val_loss: 0.0387 - val_acc: 0.1148

Epoch 00018: val_loss improved from 0.03867 to 0.03865, saving model to saved_models/model_and_weights.hdf5
Epoch 19/20
 - 155s - loss: 0.0360 - acc: 0.8006 - val_loss: 0.0386 - val_acc: 0.1111

Epoch 00019: val_loss improved from 0.03865 to 0.03864, saving model to saved_models/model_and_weights.hdf5
Epoch 20/20
 - 155s - loss: 0.0360 - acc: 0.8006 - val_loss: 0.0386 - val_acc: 0.1184

Epoch 00020: val_loss did not improve from 0.03864

Epoch 00020: ReduceLROnPlateau reducing learning rate to 3.906250185536919e-06.
*********************************************************
Running python analyze_model.py
JOB 5419 is running on node01 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25

IoU for Background is: 0.724
IoU for Cosmic is: 0.120
IoU for Beam is: 0.013

Average IoU is: 0.286

Test accuracy of the model is: 57.36%

Done!

